/**
 * Particleground
 *
 * @author Jonathan Nicol - @mrjnicol
 * @version 1.0.1
 * @description Creates a canvas based particle system background
 *
 * Inspired by:
 * http://requestlab.fr/
 * http://disruptivebydesign.com/
 * 
 * @license The MIT License (MIT)
 * 
 * Copyright (c) 2014 Jonathan Nicol - @mrjnicol
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
!function(n){function r(r,u){function it(){var r,t,i;if(w){for($canvas=n('<canvas class="pg-canvas"><\/canvas>'),o.prepend($canvas),s=$canvas[0],e=s.getContext("2d"),y(),r=Math.round(s.width*s.height/u.density),t=0;r>t;t++)i=new h,i.setStackPos(t),f.push(i);n(window).on("resize",function(){rt()});n(document).on("mousemove",function(n){b=n.pageX;k=n.pageY});g&&!d&&window.addEventListener("deviceorientation",function(){tt=Math.min(Math.max(-event.beta,-30),30);nt=Math.min(Math.max(-event.gamma,-30),30)},!0);c();p("onInit")}}function y(){s.width=o.width();s.height=o.height();e.fillStyle=u.dotColor;e.strokeStyle=u.lineColor;e.lineWidth=u.lineWidth}function c(){var t;if(w){for(l=n(window).width(),a=n(window).height(),e.clearRect(0,0,s.width,s.height),t=0;t<f.length;t++)f[t].updatePosition();for(t=0;t<f.length;t++)f[t].draw();v||(st=requestAnimationFrame(c))}}function rt(){var n,t;for(y(),i=f.length-1;i>=0;i--)(f[i].position.x>o.width()||f[i].position.y>o.height())&&f.splice(i,1);if(n=Math.round(s.width*s.height/u.density),n>f.length)for(;n>f.length;)t=new h,f.push(t);else n<f.length&&f.splice(n);for(i=f.length-1;i>=0;i--)f[i].setStackPos(i)}function ut(){v=!0}function ft(){v=!1;c()}function h(){switch(this.stackPos,this.active=!0,this.layer=Math.ceil(3*Math.random()),this.parallaxOffsetX=0,this.parallaxOffsetY=0,this.position={x:Math.ceil(Math.random()*s.width),y:Math.ceil(Math.random()*s.height)},this.speed={},u.directionX){case"left":this.speed.x=+(-u.maxSpeedX+Math.random()*u.maxSpeedX-u.minSpeedX).toFixed(2);break;case"right":this.speed.x=+(Math.random()*u.maxSpeedX+u.minSpeedX).toFixed(2);break;default:this.speed.x=+(-u.maxSpeedX/2+Math.random()*u.maxSpeedX).toFixed(2);this.speed.x+=this.speed.x>0?u.minSpeedX:-u.minSpeedX}switch(u.directionY){case"up":this.speed.y=+(-u.maxSpeedY+Math.random()*u.maxSpeedY-u.minSpeedY).toFixed(2);break;case"down":this.speed.y=+(Math.random()*u.maxSpeedY+u.minSpeedY).toFixed(2);break;default:this.speed.y=+(-u.maxSpeedY/2+Math.random()*u.maxSpeedY).toFixed(2);this.speed.x+=this.speed.y>0?u.minSpeedY:-u.minSpeedY}}function et(n,t){return t?void(u[n]=t):u[n]}function ot(){o.find(".pg-canvas").remove();p("onDestroy");o.removeData("plugin_"+t)}function p(n){void 0!==u[n]&&u[n].call(ht)}var s,e,st,l,a,ht=r,o=n(r),w=!!document.createElement("canvas").getContext,f=[],b=0,k=0,d=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),g=!!window.DeviceOrientationEvent,nt=0,tt=0,v=!1;return u=n.extend({},n.fn[t].defaults,u),h.prototype.draw=function(){var t;for(e.beginPath(),e.arc(this.position.x+this.parallaxOffsetX,this.position.y+this.parallaxOffsetY,u.particleRadius/2,0,2*Math.PI,!0),e.closePath(),e.fill(),e.beginPath(),t=f.length-1;t>this.stackPos;t--){var n=f[t],i=this.position.x-n.position.x,r=this.position.y-n.position.y,o=Math.sqrt(i*i+r*r).toFixed(2);o<u.proximity&&(e.moveTo(this.position.x+this.parallaxOffsetX,this.position.y+this.parallaxOffsetY),u.curvedLines?e.quadraticCurveTo(Math.max(n.position.x,n.position.x),Math.min(n.position.y,n.position.y),n.position.x+n.parallaxOffsetX,n.position.y+n.parallaxOffsetY):e.lineTo(n.position.x+n.parallaxOffsetX,n.position.y+n.parallaxOffsetY))}e.stroke();e.closePath()},h.prototype.updatePosition=function(){var n,t;u.parallax&&(g&&!d?(n=(+l)/60,pointerX=(nt- -30)*n+0,t=(+a)/60,pointerY=(tt- -30)*t+0):(pointerX=b,pointerY=k),this.parallaxTargX=(pointerX-l/2)/(u.parallaxMultiplier*this.layer),this.parallaxOffsetX+=(this.parallaxTargX-this.parallaxOffsetX)/10,this.parallaxTargY=(pointerY-a/2)/(u.parallaxMultiplier*this.layer),this.parallaxOffsetY+=(this.parallaxTargY-this.parallaxOffsetY)/10);switch(u.directionX){case"left":this.position.x+this.speed.x+this.parallaxOffsetX<0&&(this.position.x=o.width()-this.parallaxOffsetX);break;case"right":this.position.x+this.speed.x+this.parallaxOffsetX>o.width()&&(this.position.x=0-this.parallaxOffsetX);break;default:(this.position.x+this.speed.x+this.parallaxOffsetX>o.width()||this.position.x+this.speed.x+this.parallaxOffsetX<0)&&(this.speed.x=-this.speed.x)}switch(u.directionY){case"up":this.position.y+this.speed.y+this.parallaxOffsetY<0&&(this.position.y=o.height()-this.parallaxOffsetY);break;case"down":this.position.y+this.speed.y+this.parallaxOffsetY>o.height()&&(this.position.y=0-this.parallaxOffsetY);break;default:(this.position.y+this.speed.y+this.parallaxOffsetY>o.height()||this.position.y+this.speed.y+this.parallaxOffsetY<0)&&(this.speed.y=-this.speed.y)}this.position.x+=this.speed.x;this.position.y+=this.speed.y},h.prototype.setStackPos=function(n){this.stackPos=n},it(),{option:et,destroy:ot,start:ft,pause:ut}}var t="particleground";n.fn[t]=function(i){if("string"==typeof arguments[0]){var u,f=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.each(function(){n.data(this,"plugin_"+t)&&"function"==typeof n.data(this,"plugin_"+t)[f]&&(u=n.data(this,"plugin_"+t)[f].apply(this,e))}),void 0!==u?u:this}if("object"==typeof i||!i)return this.each(function(){n.data(this,"plugin_"+t)||n.data(this,"plugin_"+t,new r(this,i))})};n.fn[t].defaults={minSpeedX:.1,maxSpeedX:.7,minSpeedY:.1,maxSpeedY:.7,directionX:"center",directionY:"center",density:1e4,dotColor:"#666666",lineColor:"#666666",particleRadius:7,lineWidth:1,curvedLines:!1,proximity:100,parallax:!0,parallaxMultiplier:5,onInit:function(){},onDestroy:function(){}}}(jQuery),function(){for(var i=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();$(function(){$("#particles").particleground({minSpeedX:.1,maxSpeedX:.7,minSpeedY:.1,maxSpeedY:.7,directionX:"center",directionY:"center",density:1e4,dotColor:"#eee",lineColor:"#eee",particleRadius:7,lineWidth:1,curvedLines:!0,proximity:100,parallax:!1})});
//# sourceMappingURL=particles.min.js.map
